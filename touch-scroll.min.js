(function(b){var c={y:0,scrollHeight:0,elastic:!navigator.userAgent.match(/android/i),momentum:true,elasticDamp:0.6,elasticTime:50,reboundTime:400,momentumDamp:0.9,momentumTime:300,iPadMomentumDamp:0.95,iPadMomentumTime:1200};var a={init:function(d){return this.each(function(){if(b(this).data("touchscroll")){return this.update()}var p=b(this),A=b.extend(c,d),D=-A.y,s=0,t=0,l=0,x=0,B=0,H=0,v=false,f=false,n=false,J,y=!!navigator.platform.match(/ipad/i),k="WebKitCSSMatrix" in window,u=k&&"m11" in new WebKitCSSMatrix();p.data("touchscroll",true);var r=this.update=function(){x=p.height();H=A.scrollHeight||p.attr("scrollHeight");if(H<x){H=x}B=x-H;clearTimeout(J);z(false)};r();p.css({"-webkit-transition-property":"-webkit-transform","-webkit-transition-timing-function":"cubic-bezier(0,0,0.2,1)","-webkit-transition-duration":"0","-webkit-transform":j(D)});window.addEventListener("onorientationchange" in window?"orientationchange":"resize",r,false);p.bind("touchstart.touchScroll",e);p.bind("touchmove.touchScroll",G);p.bind("touchend.touchScroll touchcancel.touchScroll",i);p.bind("webkitTransitionEnd.touchScroll",q);var h=this.setPosition=function(o){D=o;p.css("-webkit-transform",j(D))};function j(o){return"translate"+(u?"3d(0,":"(0,")+o+"px"+(u?",0)":")")}function w(o){o=o||"0";p.css("-webkit-transition-duration",o+"ms")}function I(){if(k){var K=window.getComputedStyle(p[0]).webkitTransform;if(!!K&&K!=="none"){var o=new WebKitCSSMatrix(K);return o.f}}return D}this.getPosition=function(){return I()};function C(){if(D>0){g(0,A.reboundTime)}else{if(D<B){g(B,A.reboundTime)}}}function q(){if(f){f=false;C()}clearTimeout(J)}function z(K){if(!k||f){return}var o=l;l=I();if(l>0){if(A.elastic){f=true;D=0;F(l-o,A.elasticDamp,1,x,A.elasticTime)}else{w(0);h(0)}}else{if(l<B){if(A.elastic){f=true;D=B;F(l-o,A.elasticDamp,1,x,A.elasticTime)}else{w(0);h(B)}}else{if(K){J=setTimeout(z,20,true)}}}}function g(o,K){if(o===D){return}n=true;w(K);h(o)}function F(P,L,K,N,M){var O=Math.abs(P),o=0;while(O>0.1){O*=L;o+=O}if(o>N){o=N}if(o>K){if(P<0){o=-o}g(D+Math.round(o),M)}z(true)}function E(o){if(o.originalEvent){if(o.originalEvent.touches&&o.originalEvent.touches.length){return o.originalEvent.touches}else{if(o.originalEvent.changedTouches&&o.originalEvent.changedTouches.length){return o.originalEvent.changedTouches}}}return o.touches}function e(K){if(K.target.tagName==="SELECT"){return}K.preventDefault();K.stopPropagation();var o=E(K);v=true;n=false;t=0;clearTimeout(J);w(0);if(A.momentum){var L=I();if(L!==D){h(L);n=true}}s=o[0].pageY-D}function G(L){if(!v){return}var K=E(L),o=K[0].pageY-s;if(o>0){if(A.elastic){o/=2}else{o=0}}else{if(o<B){if(A.elastic){o=(o+B)/2}else{o=B}}}t=o-D;n=true;h(o)}function m(o,M,L){var K=document.createEvent("MouseEvent");K.initMouseEvent(o,true,true,M.view,1,M.screenX,M.screenY,M.clientX,M.clientY,false,false,false,false,0,null);L.dispatchEvent(K)}function i(L){if(!v){return}v=false;var K=E(L);if(n){if(D>0||D<B){C()}else{if(A.momentum){F(t,y?A.iPadMomentumDamp:A.momentumDamp,40,2000,y?A.iPadMomentumTime:A.momentumTime)}}}else{var M=K[0],o=M.target;while(o.nodeType!==1){o=o.parentNode}m("mousedown",M,o);m("mouseup",M,o);m("click",M,o)}}})},update:function(){return this.each(function(){this.update()})},getPosition:function(){var d=[];this.each(function(){d.push(-this.getPosition())});return d},setPosition:function(d){return this.each(function(){this.setPosition(-d)})}};b.fn.touchScroll=function(d){if(a[d]){return a[d].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof d==="object"||!d){return a.init.apply(this,arguments)}else{b.error("Method "+d+" does not exist on jQuery.touchScroll")}}}})(jQuery);